### Lab 2: Flight Delay Analysis

In this lab, you will analyze a real-world dataset -- information about US flight delays in January 2016, courtesy of the United States Department of Transportation. You can [download additional datasets](http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time) later. Here's another example you might find interesting -- [US border crossing/entry data per port of entry](http://transborder.bts.gov/programs/international/transborder/TBDR_BC/TBDR_BCQ.html).

___

#### Task 1: Importing the Data

Spark 2.X ships with a built-in csv reader for the DataFrame API. Because DataFrame is an abstraction over the RDD API, we will read the airline-delays.csv file as DataFrame while using the underneath RDD Object. In the next slides, we will talk more deeply about the DataFrame API, but for now, just use these lines in order to read the file: 

```python
flightsDf = spark.read.option("header", "true").csv("file:////home/ubuntu/data/airline-delays.csv")
flights = flightsDf.rdd
```

___

#### Task 2: Inspecting the Data

This dataset ships with two files (in the `~/data` directory, if you are using the instructor-provided appliance). First, the `airline-format.html` file contains a brief description of the dataset, and the various data fields. For example, the `ArrDelay` field is the flight's arrival delay, in minutes. Second, the `airline-delays.csv` file is a comma-separated collection of flight records, one record per line.

Inspect the fields described in the `airline-format.html` file. Make a note of fields that describe the flight, its origin and destination airports, and any delays encountered on departure and arrival.

Let's start by counting the number of records in our dataset. Run the following command in a terminal window:

```
flights.count()
```

This dataset has hundreds of thousands of records. To sample 0.005% of the number of records from the dataset, run the following command (for convenience, its output is also quoted here):

```
flights.sample(False, 0.005).collect()
[Row(Year='2016', Quarter='1', Month='1', DayofMonth='18', DayOfWeek='1', FlightDate='2016-01-18', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N3LEAA', FlightNum='44', OriginAirportID='14747', OriginAirportSeqID='1474703', OriginCityMarketID='30559', Origin='SEA', OriginCityName='Seattle, WA', OriginState='WA', OriginStateFips='53', OriginStateName='Washington', OriginWac='93', DestAirportID='12478', DestAirportSeqID='1247803', DestCityMarketID='31703', Dest='JFK', DestCityName='New York, NY', DestState='NY', DestStateFips='36', DestStateName='New York', DestWac='22', CRSDepTime='0645', DepTime='0641', DepDelay='-4.00', DepDelayMinutes='0.00', DepDel15='0.00', DepartureDelayGroups='-1', DepTimeBlk='0600-0659', TaxiOut='19.00', WheelsOff='0700', WheelsOn='1433', TaxiIn='6.00', CRSArrTime='1506', ArrTime='1439', ArrDelay='-27.00', ArrDelayMinutes='0.00', ArrDel15='0.00', ArrivalDelayGroups='-2', ArrTimeBlk='1500-1559', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='321.00', ActualElapsedTime='298.00', AirTime='273.00', Flights='1.00', Distance='2422.00', DistanceGroup='10', CarrierDelay=None, WeatherDelay=None, NASDelay=None, SecurityDelay=None, LateAircraftDelay=None, FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 Row(Year='2016', Quarter='1', Month='1', DayofMonth='9', DayOfWeek='6', FlightDate='2016-01-09', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N3HXAA', FlightNum='45', OriginAirportID='12478', OriginAirportSeqID='1247803', OriginCityMarketID='31703', Origin='JFK', OriginCityName='New York, NY', OriginState='NY', OriginStateFips='36', OriginStateName='New York', OriginWac='22', DestAirportID='14747', DestAirportSeqID='1474703', DestCityMarketID='30559', Dest='SEA', DestCityName='Seattle, WA', DestState='WA', DestStateFips='53', DestStateName='Washington', DestWac='93', CRSDepTime='1830', DepTime='1930', DepDelay='60.00', DepDelayMinutes='60.00', DepDel15='1.00', DepartureDelayGroups='4', DepTimeBlk='1800-1859', TaxiOut='33.00', WheelsOff='2003', WheelsOn='2220', TaxiIn='6.00', CRSArrTime='2152', ArrTime='2226', ArrDelay='34.00', ArrDelayMinutes='34.00', ArrDel15='1.00', ArrivalDelayGroups='2', ArrTimeBlk='2100-2159', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='382.00', ActualElapsedTime='356.00', AirTime='317.00', Flights='1.00', Distance='2422.00', DistanceGroup='10', CarrierDelay='27.00', WeatherDelay='0.00', NASDelay='0.00', SecurityDelay='0.00', LateAircraftDelay='7.00', FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 Row(Year='2016', Quarter='1', Month='1', DayofMonth='11', DayOfWeek='1', FlightDate='2016-01-11', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N3LPAA', FlightNum='52', OriginAirportID='12892', OriginAirportSeqID='1289203', OriginCityMarketID='32575', Origin='LAX', OriginCityName='Los Angeles, CA', OriginState='CA', OriginStateFips='06', OriginStateName='California', OriginWac='91', DestAirportID='11278', DestAirportSeqID='1127803', DestCityMarketID='30852', Dest='DCA', DestCityName='Washington, DC', DestState='VA', DestStateFips='51', DestStateName='Virginia', DestWac='38', CRSDepTime='1315', DepTime='1314', DepDelay='-1.00', DepDelayMinutes='0.00', DepDel15='0.00', DepartureDelayGroups='-1', DepTimeBlk='1300-1359', TaxiOut='14.00', WheelsOff='1328', WheelsOn='2057', TaxiIn='5.00', CRSArrTime='2110', ArrTime='2102', ArrDelay='-8.00', ArrDelayMinutes='0.00', ArrDel15='0.00', ArrivalDelayGroups='-1', ArrTimeBlk='2100-2159', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='295.00', ActualElapsedTime='288.00', AirTime='269.00', Flights='1.00', Distance='2311.00', DistanceGroup='10', CarrierDelay=None, WeatherDelay=None, NASDelay=None, SecurityDelay=None, LateAircraftDelay=None, FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 Row(Year='2016', Quarter='1', Month='1', DayofMonth='31', DayOfWeek='7', FlightDate='2016-01-31', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N3MXAA', FlightNum='71', OriginAirportID='11298', OriginAirportSeqID='1129804', OriginCityMarketID='30194', Origin='DFW', OriginCityName='Dallas/Fort Worth, TX', OriginState='TX', OriginStateFips='48', OriginStateName='Texas', OriginWac='74', DestAirportID='12889', DestAirportSeqID='1288903', DestCityMarketID='32211', Dest='LAS', DestCityName='Las Vegas, NV', DestState='NV', DestStateFips='32', DestStateName='Nevada', DestWac='85', CRSDepTime='1705', DepTime='1709', DepDelay='4.00', DepDelayMinutes='4.00', DepDel15='0.00', DepartureDelayGroups='0', DepTimeBlk='1700-1759', TaxiOut='35.00', WheelsOff='1744', WheelsOn='1823', TaxiIn='14.00', CRSArrTime='1807', ArrTime='1837', ArrDelay='30.00', ArrDelayMinutes='30.00', ArrDel15='1.00', ArrivalDelayGroups='2', ArrTimeBlk='1800-1859', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='182.00', ActualElapsedTime='208.00', AirTime='159.00', Flights='1.00', Distance='1055.00', DistanceGroup='5', CarrierDelay='0.00', WeatherDelay='0.00', NASDelay='30.00', SecurityDelay='0.00', LateAircraftDelay='0.00', FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 Row(Year='2016', Quarter='1', Month='1', DayofMonth='10', DayOfWeek='7', FlightDate='2016-01-10', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N3KUAA', FlightNum='78', OriginAirportID='14869', OriginAirportSeqID='1486903', OriginCityMarketID='34614', Origin='SLC', OriginCityName='Salt Lake City, UT', OriginState='UT', OriginStateFips='49', OriginStateName='Utah', OriginWac='87', DestAirportID='11298', DestAirportSeqID='1129804', DestCityMarketID='30194', Dest='DFW', DestCityName='Dallas/Fort Worth, TX', DestState='TX', DestStateFips='48', DestStateName='Texas', DestWac='74', CRSDepTime='1547', DepTime='1551', DepDelay='4.00', DepDelayMinutes='4.00', DepDel15='0.00', DepartureDelayGroups='0', DepTimeBlk='1500-1559', TaxiOut='19.00', WheelsOff='1610', WheelsOn='1914', TaxiIn='8.00', CRSArrTime='1923', ArrTime='1922', ArrDelay='-1.00', ArrDelayMinutes='0.00', ArrDel15='0.00', ArrivalDelayGroups='-1', ArrTimeBlk='1900-1959', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='156.00', ActualElapsedTime='151.00', AirTime='124.00', Flights='1.00', Distance='989.00', DistanceGroup='4', CarrierDelay=None, WeatherDelay=None, NASDelay=None, SecurityDelay=None, LateAircraftDelay=None, FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 Row(Year='2016', Quarter='1', Month='1', DayofMonth='18', DayOfWeek='1', FlightDate='2016-01-18', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N555AA', FlightNum='80', OriginAirportID='15376', OriginAirportSeqID='1537602', OriginCityMarketID='30436', Origin='TUS', OriginCityName='Tucson, AZ', OriginState='AZ', OriginStateFips='04', OriginStateName='Arizona', OriginWac='81', DestAirportID='11298', DestAirportSeqID='1129804', DestCityMarketID='30194', Dest='DFW', DestCityName='Dallas/Fort Worth, TX', DestState='TX', DestStateFips='48', DestStateName='Texas', DestWac='74', CRSDepTime='1232', DepTime='1234', DepDelay='2.00', DepDelayMinutes='2.00', DepDel15='0.00', DepartureDelayGroups='0', DepTimeBlk='1200-1259', TaxiOut='10.00', WheelsOff='1244', WheelsOn='1530', TaxiIn='10.00', CRSArrTime='1544', ArrTime='1540', ArrDelay='-4.00', ArrDelayMinutes='0.00', ArrDel15='0.00', ArrivalDelayGroups='-1', ArrTimeBlk='1500-1559', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='132.00', ActualElapsedTime='126.00', AirTime='106.00', Flights='1.00', Distance='813.00', DistanceGroup='4', CarrierDelay=None, WeatherDelay=None, NASDelay=None, SecurityDelay=None, LateAircraftDelay=None, FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 Row(Year='2016', Quarter='1', Month='1', DayofMonth='6', DayOfWeek='3', FlightDate='2016-01-06', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N3LNAA', FlightNum='197', OriginAirportID='10721', OriginAirportSeqID='1072102', OriginCityMarketID='30721', Origin='BOS', OriginCityName='Boston, MA', OriginState='MA', OriginStateFips='25', OriginStateName='Massachusetts', OriginWac='13', DestAirportID='13930', DestAirportSeqID='1393004', DestCityMarketID='30977', Dest='ORD', DestCityName='Chicago, IL', DestState='IL', DestStateFips='17', DestStateName='Illinois', DestWac='41', CRSDepTime='1545', DepTime='1538', DepDelay='-7.00', DepDelayMinutes='0.00', DepDel15='0.00', DepartureDelayGroups='-1', DepTimeBlk='1500-1559', TaxiOut='18.00', WheelsOff='1556', WheelsOn='1709', TaxiIn='20.00', CRSArrTime='1745', ArrTime='1729', ArrDelay='-16.00', ArrDelayMinutes='0.00', ArrDel15='0.00', ArrivalDelayGroups='-2', ArrTimeBlk='1700-1759', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='180.00', ActualElapsedTime='171.00', AirTime='133.00', Flights='1.00', Distance='867.00', DistanceGroup='4', CarrierDelay=None, WeatherDelay=None, NASDelay=None, SecurityDelay=None, LateAircraftDelay=None, FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 Row(Year='2016', Quarter='1', Month='1', DayofMonth='13', DayOfWeek='3', FlightDate='2016-01-13', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N3LVAA', FlightNum='197', OriginAirportID='13930', OriginAirportSeqID='1393004', OriginCityMarketID='30977', Origin='ORD', OriginCityName='Chicago, IL', OriginState='IL', OriginStateFips='17', OriginStateName='Illinois', OriginWac='41', DestAirportID='10721', DestAirportSeqID='1072102', DestCityMarketID='30721', Dest='BOS', DestCityName='Boston, MA', DestState='MA', DestStateFips='25', DestStateName='Massachusetts', DestWac='13', CRSDepTime='1150', DepTime='1209', DepDelay='19.00', DepDelayMinutes='19.00', DepDel15='1.00', DepartureDelayGroups='1', DepTimeBlk='1100-1159', TaxiOut='10.00', WheelsOff='1219', WheelsOn='1500', TaxiIn='4.00', CRSArrTime='1500', ArrTime='1504', ArrDelay='4.00', ArrDelayMinutes='4.00', ArrDel15='0.00', ArrivalDelayGroups='0', ArrTimeBlk='1500-1559', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='130.00', ActualElapsedTime='115.00', AirTime='101.00', Flights='1.00', Distance='867.00', DistanceGroup='4', CarrierDelay=None, WeatherDelay=None, NASDelay=None, SecurityDelay=None, LateAircraftDelay=None, FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 Row(Year='2016', Quarter='1', Month='1', DayofMonth='22', DayOfWeek='5', FlightDate='2016-01-22', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N3DYAA', FlightNum='209', OriginAirportID='12892', OriginAirportSeqID='1289203', OriginCityMarketID='32575', Origin='LAX', OriginCityName='Los Angeles, CA', OriginState='CA', OriginStateFips='06', OriginStateName='California', OriginWac='91', DestAirportID='14771', DestAirportSeqID='1477102', DestCityMarketID='32457', Dest='SFO', DestCityName='San Francisco, CA', DestState='CA', DestStateFips='06', DestStateName='California', DestWac='91', CRSDepTime='1615', DepTime='1638', DepDelay='23.00', DepDelayMinutes='23.00', DepDel15='1.00', DepartureDelayGroups='1', DepTimeBlk='1600-1659', TaxiOut='36.00', WheelsOff='1714', WheelsOn='1817', TaxiIn='7.00', CRSArrTime='1736', ArrTime='1824', ArrDelay='48.00', ArrDelayMinutes='48.00', ArrDel15='1.00', ArrivalDelayGroups='3', ArrTimeBlk='1700-1759', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='81.00', ActualElapsedTime='106.00', AirTime='63.00', Flights='1.00', Distance='337.00', DistanceGroup='2', CarrierDelay='0.00', WeatherDelay='0.00', NASDelay='48.00', SecurityDelay='0.00', LateAircraftDelay='0.00', FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 Row(Year='2016', Quarter='1', Month='1', DayofMonth='20', DayOfWeek='3', FlightDate='2016-01-20', UniqueCarrier='AA', AirlineID='19805', Carrier='AA', TailNum='N3ADAA', FlightNum='211', OriginAirportID='12478', OriginAirportSeqID='1247803', OriginCityMarketID='31703', Origin='JFK', OriginCityName='New York, NY', OriginState='NY', OriginStateFips='36', OriginStateName='New York', OriginWac='22', DestAirportID='12889', DestAirportSeqID='1288903', DestCityMarketID='32211', Dest='LAS', DestCityName='Las Vegas, NV', DestState='NV', DestStateFips='32', DestStateName='Nevada', DestWac='85', CRSDepTime='1700', DepTime='1658', DepDelay='-2.00', DepDelayMinutes='0.00', DepDel15='0.00', DepartureDelayGroups='-1', DepTimeBlk='1700-1759', TaxiOut='23.00', WheelsOff='1721', WheelsOn='1926', TaxiIn='7.00', CRSArrTime='1959', ArrTime='1933', ArrDelay='-26.00', ArrDelayMinutes='0.00', ArrDel15='0.00', ArrivalDelayGroups='-2', ArrTimeBlk='1900-1959', Cancelled='0.00', CancellationCode=None, Diverted='0.00', CRSElapsedTime='359.00', ActualElapsedTime='335.00', AirTime='305.00', Flights='1.00', Distance='2248.00', DistanceGroup='9', CarrierDelay=None, WeatherDelay=None, NASDelay=None, SecurityDelay=None, LateAircraftDelay=None, FirstDepTime=None, TotalAddGTime=None, LongestAddGTime=None, DivAirportLandings='0', DivReachedDest=None, DivActualElapsedTime=None, DivArrDelay=None, DivDistance=None, Div1Airport=None, Div1AirportID=None, Div1AirportSeqID=None, Div1WheelsOn=None, Div1TotalGTime=None, Div1LongestGTime=None, Div1WheelsOff=None, Div1TailNum=None, Div2Airport=None, Div2AirportID=None, Div2AirportSeqID=None, Div2WheelsOn=None, Div2TotalGTime=None, Div2LongestGTime=None, Div2WheelsOff=None, Div2TailNum=None, Div3Airport=None, Div3AirportID=None, Div3AirportSeqID=None, Div3WheelsOn=None, Div3TotalGTime=None, Div3LongestGTime=None, Div3WheelsOff=None, Div3TailNum=None, Div4Airport=None, Div4AirportID=None, Div4AirportSeqID=None, Div4WheelsOn=None, Div4TotalGTime=None, Div4LongestGTime=None, Div4WheelsOff=None, Div4TailNum=None, Div5Airport=None, Div5AirportID=None, Div5AirportSeqID=None, Div5WheelsOn=None, Div5TotalGTime=None, Div5LongestGTime=None, Div5WheelsOff=None, Div5TailNum=None, _c109=None),
 ...
```

This displays the all the fields of the first 10 sampled records from the file.   

___

#### Task 3: Querying Flights and Delays

Now that you have the flight objects, it's time to perform a few queries and gather some useful information. Suppose you're in Boston, MA. Which airline has the most flights departing from Boston?

**Solution**:

```python
flightsByCarrier = flights.filter(
      lambda flight: flight['OriginCityName'] == "Boston, MA")    \
                           .map(lambda flight: flight['Carrier']) \
                           .countByValue()
sorted(flightsByCarrier.items(), key=lambda p: -p[1])[0]
```

Living in Chicago, IL, what are the farthest 10 destinations that you could fly to? (Note that our dataset contains only US domestic flights.)

**Solution**:

```python
flights.filter(lambda f: f['OriginCityName'] == "Chicago, IL")      \
       .map(lambda f: (f['DestCityName'], float(f['Distance'])))    \
       .distinct()                                                  \
       .sortBy(lambda tup: -tup[1])                                 \
       .take(10)
```

Suppose you're in New York, NY and are contemplating direct flights to San Francisco, CA. In terms of arrival delay, which airline has the best record on that route?

**Solution**:

```python
flights.filter(lambda flight: flight['OriginCityName'] == "New York, NY" and
                              flight['DestCityName'] == "San Francisco, CA" and
                              flight['ArrDelay'] != '' and flight['ArrDelay'] != None)                       \
       .map(lambda flight: (flight['Carrier'], float(flight['ArrDelay'])))    \
       .reduceByKey(lambda a, b: a + b)                                       \
       .sortBy(lambda tup: -tup[1])                                           \
       .first()
```

___

### Discussion

Suppose you had to calculate multiple aggregated values from the `flights` RDD -- e.g., the average arrival delay, the average departure delay, and the average flight duration for flights from Boston. How would you express it using SQL, if `flights` was a table in a relational database? How would you express it using transformations and actions on RDDs? Which is easier to develop and maintain?
